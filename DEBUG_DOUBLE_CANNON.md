# 双响炮识别调试指南

## 概述
本文档说明如何使用新增的调试日志来诊断为什么某些股票（如603093.SH南华期货）没有双响炮预测结果。

## 新增的调试日志

### 1. 主要模式识别日志
在 `internal/indicators/patterns.go` 中添加了以下日志：

```go
[模式识别] 开始识别模式，共 X 天数据
[模式识别] 分析日期: YYYYMMDD (索引: N)
[模式识别] 在日期 YYYYMMDD 识别到 X 个蜡烛图模式和 Y 个量价模式
[模式识别] 识别完成，共找到 X 个结果
```

### 2. 蜡烛图模式识别日志
```go
[蜡烛图识别] 开始识别蜡烛图模式，日期: YYYYMMDD
[蜡烛图识别] ✅ 识别到双响炮模式
[蜡烛图识别] ✅ 识别到红三兵模式
[蜡烛图识别] 识别完成，共找到 X 个蜡烛图模式
```

### 3. 双响炮识别详细日志
```go
[双响炮识别] 股票: XXXXXX.XX, 日期: YYYYMMDD
[双响炮识别] 第一根K线 - 开盘: X.XX, 收盘: X.XX, 涨幅: X.XX%, 是否阳线: true/false
[双响炮识别] 第二根K线 - 开盘: X.XX, 收盘: X.XX, 涨幅: X.XX%, 是否阳线: true/false
[双响炮识别] 成交量比率: X.XX (当前: XXXX, 前一日: XXXX)
[双响炮识别] 判断条件检查:
  条件1 (第一根涨幅>2%): true/false (实际: X.XX%)
  条件2 (第二根涨幅>3%): true/false (实际: X.XX%)
  条件3 (成交量比率>1.5): true/false (实际: X.XX)
  条件4 (第一根是阳线): true/false
  条件5 (第二根是阳线): true/false
[双响炮识别] ✅ 所有条件满足，识别到双响炮模式!
[双响炮识别] 置信度: X.XX, 强度: STRONG/MEDIUM/WEAK
[双响炮识别] ❌ 条件不满足，未识别到双响炮模式
```

## 双响炮识别条件

双响炮模式需要满足以下所有条件：

1. **第一根K线涨幅 > 2%**
2. **第二根K线涨幅 > 3%**
3. **第二根成交量是第一根的1.5倍以上**
4. **两根K线都是阳线**（收盘价 > 开盘价）

## 使用方法

### 1. 运行测试验证日志
```bash
go test -v ./internal/indicators -run TestPatternRecognizer_RecognizeDoubleCannon_603093
```

### 2. 查看实际股票数据
当你在实际环境中查询股票时，这些日志会自动输出到控制台，帮助你诊断：

- 哪些条件没有满足
- 具体的数值是多少
- 为什么没有识别出双响炮模式

### 3. 日志输出示例
```
2025/08/17 20:46:24 [双响炮识别] 股票: 603093.SH, 日期: 20240103
2025/08/17 20:46:24 [双响炮识别] 第一根K线 - 开盘: 15.3, 收盘: 15.8, 涨幅: 3.27%, 是否阳线: true
2025/08/17 20:46:24 [双响炮识别] 第二根K线 - 开盘: 15.8, 收盘: 16.3, 涨幅: 3.16%, 是否阳线: true
2025/08/17 20:46:24 [双响炮识别] 成交量比率: 1.67 (当前: 3000, 前一日: 1800)
2025/08/17 20:46:24 [双响炮识别] 判断条件检查:
  条件1 (第一根涨幅>2%): true (实际: 3.27%)
  条件2 (第二根涨幅>3%): true (实际: 3.16%)
  条件3 (成交量比率>1.5): true (实际: 1.67)
  条件4 (第一根是阳线): true
  条件5 (第二根是阳线): true
2025/08/17 20:46:24 [双响炮识别] ✅ 所有条件满足，识别到双响炮模式!
```

## 常见问题诊断

### 问题1: 涨幅不够
- 检查第一根K线涨幅是否 > 2%
- 检查第二根K线涨幅是否 > 3%

### 问题2: 成交量不足
- 检查第二根成交量是否是第一根的1.5倍以上
- 注意：如果前一天成交量很大，第二天需要更大的成交量

### 问题3: 不是阳线
- 检查两根K线的收盘价是否都大于开盘价
- 即使涨幅满足条件，如果不是阳线也不会识别

### 问题4: 数据不足
- 需要至少3天的数据才能开始识别
- 从第3天开始，每天都会尝试识别双响炮

## 调试建议

1. **先运行测试**：确保代码逻辑正确
2. **查看实际数据**：了解股票的真实K线数据
3. **分析日志输出**：找出哪个条件没有满足
4. **调整识别参数**：如果条件过于严格，可以考虑适当放宽

## 注意事项

- 日志会输出到标准输出，在生产环境中注意日志级别
- 双响炮识别是基于技术分析，仅供参考
- 建议结合其他技术指标和基本面分析
