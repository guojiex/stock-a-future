---
alwaysApply: true
---

# Stock-A-Future 项目开发规范

## 🔧 技术栈要求

### Go语言规范
- **版本要求**: 使用 Go 1.24 或更高版本
- **模块管理**: 严格使用 go.mod 进行依赖管理
- **代码风格**: 遵循官方 Go Code Review Comments 规范
- **HTTP框架**: 使用标准库 `net/http` 和 Go 1.22+ 的增强版 `ServeMux`

### 前端技术栈
- **CSS框架**: TailwindCSS + DaisyUI
- **图表库**: ECharts (本地版本，非CDN)
- **JavaScript**: 原生ES6+，模块化架构
- **构建工具**: TailwindCSS CLI

## 📋 代码质量标准

### Go代码规范
1. **错误处理**:
   - 使用标准库 `errors` 包进行错误包装
   - 实现结构化错误类型，包含错误码和详细信息
   - 避免使用中文错误信息，便于国际化

2. **并发处理**:
   - 必须使用 `context` 包管理请求生命周期
   - 使用 `sync` 包进行并发控制
   - 避免大范围锁定，优化性能

3. **API设计**:
   - 严格遵循RESTful设计原则
   - 使用统一的JSON响应格式
   - 实现适当的HTTP状态码
   - 添加请求验证和输入检查

4. **数据库操作**:
   - 使用事务确保数据一致性
   - 实现连接池管理
   - 添加SQL查询超时控制

### 前端代码规范
1. **JavaScript**:
   - 使用ES6+模块语法 (`import/export`)
   - 实现错误边界和异常处理
   - 使用 `async/await` 处理异步操作
   - 避免全局变量，使用命名空间

2. **CSS/样式**:
   - 优先使用TailwindCSS工具类
   - 使用DaisyUI组件系统
   - 实现响应式设计
   - 避免内联样式

3. **用户体验**:
   - 实现加载状态指示器
   - 添加错误提示和用户反馈
   - 确保无障碍访问性(a11y)

## 🏗️ 架构模式

### 后端架构
- **分层架构**: `cmd` → `internal/handler` → `internal/service` → `internal/models`
- **依赖注入**: 使用构造函数注入，避免全局变量
- **接口设计**: 定义清晰的接口边界，便于测试和扩展
- **中间件模式**: 实现日志记录、CORS、认证等横切关注点

### 前端架构
- **模块化设计**: 按功能划分JavaScript模块
- **服务层**: 统一的API调用服务
- **组件化**: 可复用的UI组件
- **状态管理**: 集中式状态管理模式

## 🧪 测试要求

### 测试覆盖率
- **单元测试**: 核心业务逻辑 > 80%
- **集成测试**: API端点测试
- **基准测试**: 性能关键路径
- **模糊测试**: 输入验证和边界条件

### 测试规范
- 使用 `testing` 包进行测试
- 实现Mock对象进行依赖隔离
- 使用表驱动测试模式
- 添加测试数据清理逻辑

## 🔒 安全要求

### API安全
- 实现请求速率限制
- 添加输入验证和SQL注入防护
- 设置适当的CORS策略
- 使用HTTPS传输敏感数据

### 数据安全
- 敏感信息脱敏处理
- 实现数据备份和恢复
- 添加审计日志记录

## 📊 性能优化

### 后端优化
- 实现数据缓存策略 (`DailyCacheService`)
- 使用连接池管理数据库连接
- 实现异步处理长时间任务
- 添加监控和指标收集

### 前端优化
- 实现懒加载和代码分割
- 优化图表渲染性能
- 使用防抖和节流技术
- 缓存静态资源

## 🚀 开发流程

### 代码提交
- 使用语义化提交信息
- 运行 `make fmt` 和 `make vet` 检查代码
- 确保所有测试通过
- 更新相关文档

### 部署要求
- 支持Docker容器化部署
- 实现健康检查端点
- 配置日志轮转和监控
- 支持优雅关闭

## 🔧 开发工具配置

### 必需的开发工具
```bash
# 代码格式化
make fmt

# 代码检查  
make vet

# 运行测试
make test

# 构建前端资源
npm run build:css
```

### IDE配置建议
- 启用Go模块支持
- 配置自动格式化 (gofmt)
- 启用静态分析工具
- 配置TailwindCSS智能提示

---

**重要**: 所有代码更改必须保持向后兼容，不能破坏现有的API接口和数据结构。在进行重构时，优先考虑渐进式改进而非激进式重写。