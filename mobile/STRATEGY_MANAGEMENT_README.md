# ç­–ç•¥ç®¡ç†åŠŸèƒ½å®ç°æ–‡æ¡£

## ğŸ“‹ æ¦‚è¿°

åŸºäºWebç‰ˆæœ¬çš„æ”¶è—ç®¡ç†åŠŸèƒ½,åœ¨React Nativeç§»åŠ¨ç«¯å®ç°äº†å®Œæ•´çš„ç­–ç•¥ç®¡ç†ç³»ç»Ÿã€‚ç”¨æˆ·å¯ä»¥å°†å…³æ³¨çš„è‚¡ç¥¨æ·»åŠ ä¸ºç­–ç•¥,è¿›è¡Œåˆ†ç»„ç®¡ç†,å¹¶æŸ¥çœ‹ä¿¡å·æ±‡æ€»ã€‚

## âœ… å·²å®ŒæˆåŠŸèƒ½

### 1. ç­–ç•¥ç®¡ç†ä¸»é¡µé¢ (`BacktestScreen.tsx`)

**ä½ç½®**: `mobile/src/screens/Backtest/BacktestScreen.tsx`

**åŠŸèƒ½ç‰¹æ€§**:
- âœ… ç­–ç•¥åˆ—è¡¨å±•ç¤º - æ˜¾ç¤ºæ‰€æœ‰æ”¶è—çš„è‚¡ç¥¨ç­–ç•¥
- âœ… ä¿¡å·æ±‡æ€»å±•ç¤º - æŸ¥çœ‹æ‰€æœ‰ç­–ç•¥çš„ä¹°å–ä¿¡å·
- âœ… Tabåˆ‡æ¢ - åœ¨åˆ—è¡¨å’Œä¿¡å·ä¹‹é—´åˆ‡æ¢
- âœ… åˆ†ç»„ç®¡ç† - åˆ›å»ºã€ç¼–è¾‘ã€åˆ é™¤åˆ†ç»„
- âœ… åˆ†ç»„ç­›é€‰ - æŒ‰åˆ†ç»„æŸ¥çœ‹ç­–ç•¥
- âœ… ä¸‹æ‹‰åˆ·æ–° - æ”¯æŒæ•°æ®åˆ·æ–°
- âœ… ç©ºçŠ¶æ€æç¤º - å‹å¥½çš„ç©ºæ•°æ®å±•ç¤º
- âœ… åˆ é™¤ç­–ç•¥ - ä»åˆ†ç»„ä¸­ç§»é™¤ç­–ç•¥
- âœ… å¿«é€Ÿæ“ä½œ - æŸ¥çœ‹å›¾è¡¨ã€ç¼–è¾‘ç­–ç•¥

**UIç»„ä»¶**:
- é¡¶éƒ¨Tabå¯¼èˆª (ç­–ç•¥åˆ—è¡¨ / ä¿¡å·æ±‡æ€»)
- æ°´å¹³æ»šåŠ¨çš„åˆ†ç»„æ ‡ç­¾
- å¡ç‰‡å¼åˆ—è¡¨å±•ç¤º
- æµ®åŠ¨æ“ä½œæŒ‰é’® (FAB) - æ·»åŠ æ–°ç­–ç•¥
- åˆ†ç»„ç¼–è¾‘å¯¹è¯æ¡†

### 2. ç­–ç•¥ç¼–è¾‘é¡µé¢ (`StrategyEditScreen.tsx`)

**ä½ç½®**: `mobile/src/screens/Backtest/StrategyEditScreen.tsx`

**åŠŸèƒ½ç‰¹æ€§**:
- âœ… è‚¡ç¥¨æœç´¢ - æ™ºèƒ½æœç´¢è‚¡ç¥¨ä»£ç å’Œåç§°
- âœ… æ—¥æœŸé€‰æ‹© - è®¾ç½®åˆ†ææ—¶é—´èŒƒå›´
- âœ… åˆ†ç»„é€‰æ‹© - å°†ç­–ç•¥æ·»åŠ åˆ°æŒ‡å®šåˆ†ç»„
- âœ… è¡¨å•éªŒè¯ - ç¡®ä¿æ•°æ®å®Œæ•´æ€§
- âœ… ç¼–è¾‘æ¨¡å¼ - æ”¯æŒç¼–è¾‘ç°æœ‰ç­–ç•¥
- âœ… æ–°å»ºæ¨¡å¼ - æ·»åŠ æ–°çš„ç­–ç•¥

**UIç»„ä»¶**:
- è‚¡ç¥¨æœç´¢è¾“å…¥æ¡†
- æœç´¢ç»“æœä¸‹æ‹‰åˆ—è¡¨
- æ—¥æœŸé€‰æ‹©å™¨ (DateTimePicker)
- åˆ†ç»„é€‰æ‹©chips
- æ“ä½œæŒ‰é’® (å–æ¶ˆ / ä¿å­˜)

### 3. ç­–ç•¥ä¿¡å·è¯¦æƒ…é¡µé¢ (`BacktestResultScreen.tsx`)

**ä½ç½®**: `mobile/src/screens/Backtest/BacktestResultScreen.tsx`

**åŠŸèƒ½ç‰¹æ€§**:
- âœ… é¢„æµ‹ä¿¡å·å±•ç¤º - æ˜¾ç¤ºä¹°å–é¢„æµ‹ä¿¡å·
- âœ… å½¢æ€è¯†åˆ« - æ˜¾ç¤ºæŠ€æœ¯å½¢æ€åˆ†æ
- âœ… ä¿¡å·æ±‡æ€» - ç»¼åˆè¯„ä¼°å’Œç»Ÿè®¡
- âœ… Tabåˆ‡æ¢ - åœ¨ä¸åŒè§†å›¾é—´åˆ‡æ¢
- âœ… ä¸‹æ‹‰åˆ·æ–° - æ›´æ–°ä¿¡å·æ•°æ®
- âœ… è¯¦ç»†ä¿¡æ¯ - ç½®ä¿¡åº¦ã€ç†ç”±ã€ç›®æ ‡ä»·ä½ç­‰

**UIç»„ä»¶**:
- Tabå¯¼èˆª (é¢„æµ‹ä¿¡å· / å½¢æ€è¯†åˆ« / æ±‡æ€»)
- ä¿¡å·å¡ç‰‡ - æ˜¾ç¤ºä¹°å–ä¿¡å·å’Œç½®ä¿¡åº¦
- å½¢æ€å¡ç‰‡ - æ˜¾ç¤ºçœ‹æ¶¨/çœ‹è·Œå½¢æ€
- ç»Ÿè®¡å¡ç‰‡ - æ˜¾ç¤ºä¿¡å·ç»Ÿè®¡æ•°æ®

## ğŸ”Œ åç«¯æ¥å£é›†æˆ

æ‰€æœ‰åŠŸèƒ½å®Œå…¨åŸºäºç°æœ‰çš„åç«¯API,æ— éœ€é¢å¤–å¼€å‘:

### æ”¶è—ç®¡ç†API
```typescript
// è·å–æ”¶è—åˆ—è¡¨
useGetFavoritesQuery()

// æ·»åŠ æ”¶è—
useAddFavoriteMutation({
  ts_code: string,
  name: string,
  start_date: string,
  end_date: string,
  group_id?: string
})

// æ›´æ–°æ”¶è—
useUpdateFavoriteMutation({ id, data })

// åˆ é™¤æ”¶è—
useDeleteFavoriteMutation(id)

// è·å–æ”¶è—ä¿¡å·
useGetFavoritesSignalsQuery()
```

### åˆ†ç»„ç®¡ç†API
```typescript
// è·å–åˆ†ç»„åˆ—è¡¨
useGetGroupsQuery()

// åˆ›å»ºåˆ†ç»„
useCreateGroupMutation({
  name: string,
  color?: string
})

// æ›´æ–°åˆ†ç»„
useUpdateGroupMutation({ id, data })

// åˆ é™¤åˆ†ç»„
useDeleteGroupMutation(id)
```

### ä¿¡å·åˆ†æAPI
```typescript
// è·å–é¢„æµ‹ä¿¡å·
useGetPredictionsQuery(stockCode)

// å½¢æ€è¯†åˆ«
useRecognizePatternsQuery({ tsCode })

// è·å–ä¿¡å·æ‘˜è¦
useGetPatternSummaryQuery(stockCode)
```

### è‚¡ç¥¨æœç´¢API
```typescript
// æœç´¢è‚¡ç¥¨
useLazySearchStocksQuery()

// è·å–è‚¡ç¥¨åŸºæœ¬ä¿¡æ¯
useLazyGetStockBasicQuery()
```

## ğŸ“± ç”¨æˆ·ç•Œé¢è®¾è®¡

### è®¾è®¡åŸåˆ™
- **Material Design** - éµå¾ªMaterial Design 3è§„èŒƒ
- **å“åº”å¼å¸ƒå±€** - é€‚é…ä¸åŒå±å¹•å°ºå¯¸
- **ä¸­å›½è‚¡å¸‚é…è‰²** - çº¢æ¶¨ç»¿è·Œ,ç¬¦åˆç”¨æˆ·ä¹ æƒ¯
- **è§¦æ‘¸å‹å¥½** - æŒ‰é’®å¤§å°é€‚åˆè§¦æ‘¸æ“ä½œ
- **è§†è§‰åé¦ˆ** - æ¸…æ™°çš„çŠ¶æ€æç¤ºå’ŒåŠ è½½åŠ¨ç”»

### é¢œè‰²æ–¹æ¡ˆ
```typescript
// ä¿¡å·é¢œè‰²
ä¹°å…¥ä¿¡å·: #4caf50 (ç»¿è‰²)
å–å‡ºä¿¡å·: #f44336 (çº¢è‰²)
æŒæœ‰ä¿¡å·: #ff9800 (æ©™è‰²)

// åˆ†ç»„é¢œè‰²
è“è‰²: #1976d2
ç»¿è‰²: #2e7d32
æ©™è‰²: #ed6c02
çº¢è‰²: #d32f2f
ç´«è‰²: #9c27b0
é’è‰²: #0288d1
```

## ğŸ”„ æ•°æ®æµ

```
ç”¨æˆ·æ“ä½œ
    â†“
React Nativeç»„ä»¶
    â†“
RTK Query Hook
    â†“
APIæœåŠ¡å±‚ (api.ts)
    â†“
Goåç«¯æœåŠ¡
    â†“
SQLiteæ•°æ®åº“
```

## ğŸ“¦ ä¾èµ–é¡¹

### å·²ä½¿ç”¨çš„ä¾èµ–
- `react-native-paper` - Material Designç»„ä»¶åº“
- `@react-navigation/native` - å¯¼èˆªç®¡ç†
- `@reduxjs/toolkit` - çŠ¶æ€ç®¡ç†
- `react-native-vector-icons` - å›¾æ ‡åº“
- `@react-native-community/datetimepicker` - æ—¥æœŸé€‰æ‹©å™¨

### éœ€è¦å®‰è£…çš„ä¾èµ–
```bash
# å¦‚æœè¿˜æœªå®‰è£…,éœ€è¦æ‰§è¡Œ:
npm install @react-native-community/datetimepicker
```

## ğŸš€ ä½¿ç”¨æ–¹æ³•

### å¯åŠ¨åº”ç”¨
```bash
# è¿›å…¥mobileç›®å½•
cd mobile

# å®‰è£…ä¾èµ–
npm install

# å¯åŠ¨Metro bundler
npm start

# è¿è¡ŒAndroid
npm run android

# è¿è¡ŒiOS (ä»…macOS)
npm run ios
```

### ç¡®ä¿åç«¯æœåŠ¡è¿è¡Œ
```bash
# åœ¨é¡¹ç›®æ ¹ç›®å½•
go run cmd/server/main.go
# æˆ–
./server.exe
```

åç«¯æœåŠ¡åº”è¿è¡Œåœ¨ `http://localhost:8080`

## ğŸ“ ä»£ç ç»“æ„

```
mobile/src/screens/Backtest/
â”œâ”€â”€ BacktestScreen.tsx          # ç­–ç•¥ç®¡ç†ä¸»é¡µé¢
â”œâ”€â”€ StrategyEditScreen.tsx      # ç­–ç•¥ç¼–è¾‘é¡µé¢
â””â”€â”€ BacktestResultScreen.tsx    # ç­–ç•¥ä¿¡å·è¯¦æƒ…é¡µé¢
```

## ğŸ¯ å¯¼èˆªæµç¨‹

```
BacktestScreen (ç­–ç•¥ç®¡ç†)
    â”œâ”€â†’ StrategyEditScreen (æ·»åŠ /ç¼–è¾‘ç­–ç•¥)
    â”‚       â””â”€â†’ è¿”å› BacktestScreen
    â”‚
    â””â”€â†’ BacktestResultScreen (æŸ¥çœ‹ä¿¡å·è¯¦æƒ…)
            â””â”€â†’ è¿”å› BacktestScreen
```

## âš ï¸ æ³¨æ„äº‹é¡¹

1. **æ•°æ®åŒæ­¥**: ç¡®ä¿åç«¯æœåŠ¡æ­£å¸¸è¿è¡Œ,APIç«¯ç‚¹å¯è®¿é—®
2. **æ—¥æœŸæ ¼å¼**: ä½¿ç”¨YYYYMMDDæ ¼å¼ä¸åç«¯é€šä¿¡
3. **åˆ†ç»„ID**: é»˜è®¤åˆ†ç»„IDä¸º'default',ä¸å¯åˆ é™¤
4. **å¯¼èˆªå‚æ•°**: BacktestResultScreençš„backtestIdå®é™…æ˜¯è‚¡ç¥¨ä»£ç 
5. **ç±»å‹å®‰å…¨**: å·²å®šä¹‰TypeScriptæ¥å£ç¡®ä¿ç±»å‹å®‰å…¨

## ğŸ”® æœªæ¥ä¼˜åŒ–æ–¹å‘

### å»ºè®®æ·»åŠ çš„åŠŸèƒ½
1. **æ‹–æ‹½æ’åº** - ä½¿ç”¨`react-native-draggable-flatlist`å®ç°ç­–ç•¥æ’åº
2. **æ‰¹é‡æ“ä½œ** - æ”¯æŒæ‰¹é‡åˆ é™¤ã€ç§»åŠ¨ç­–ç•¥
3. **å¯¼å‡ºåŠŸèƒ½** - å¯¼å‡ºç­–ç•¥æ•°æ®ä¸ºExcelæˆ–CSV
4. **ä»·æ ¼é¢„è­¦** - è®¾ç½®ä»·æ ¼æé†’é€šçŸ¥
5. **ç­–ç•¥æ¨¡æ¿** - é¢„è®¾å¸¸ç”¨ç­–ç•¥æ¨¡æ¿
6. **æ•°æ®å¯è§†åŒ–** - æ·»åŠ æ›´å¤šå›¾è¡¨å±•ç¤º
7. **ç¦»çº¿ç¼“å­˜** - å®ç°æœ¬åœ°ç¼“å­˜æå‡æ€§èƒ½

### æ€§èƒ½ä¼˜åŒ–
- ä½¿ç”¨`React.memo`ä¼˜åŒ–åˆ—è¡¨æ¸²æŸ“
- å®ç°è™šæ‹Ÿåˆ—è¡¨æå‡é•¿åˆ—è¡¨æ€§èƒ½
- æ·»åŠ åˆ†é¡µåŠ è½½å‡å°‘åˆå§‹åŠ è½½æ—¶é—´
- ä½¿ç”¨`useMemo`å’Œ`useCallback`ä¼˜åŒ–è®¡ç®—

## ğŸ“š å‚è€ƒæ–‡æ¡£

- [React Native Paperæ–‡æ¡£](https://callstack.github.io/react-native-paper/)
- [React Navigationæ–‡æ¡£](https://reactnavigation.org/)
- [RTK Queryæ–‡æ¡£](https://redux-toolkit.js.org/rtk-query/overview)
- [Material DesignæŒ‡å—](https://m3.material.io/)

## ğŸ¤ è´¡çŒ®

å¦‚éœ€æ”¹è¿›æˆ–æ·»åŠ æ–°åŠŸèƒ½,è¯·éµå¾ªä»¥ä¸‹è§„èŒƒ:
1. ä¿æŒä»£ç é£æ ¼ä¸€è‡´
2. æ·»åŠ é€‚å½“çš„TypeScriptç±»å‹å®šä¹‰
3. ç¼–å†™æ¸…æ™°çš„æ³¨é‡Š
4. ç¡®ä¿å‘åå…¼å®¹
5. æ›´æ–°ç›¸å…³æ–‡æ¡£

## ğŸ“„ è®¸å¯è¯

éµå¾ªé¡¹ç›®ä¸»è®¸å¯è¯

---

**æœ€åæ›´æ–°**: 2025-10-11
**ä½œè€…**: AIåŠ©æ‰‹
**ç‰ˆæœ¬**: 1.0.0

