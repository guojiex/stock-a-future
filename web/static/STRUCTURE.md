# Stock-A-Future Web Client 项目结构

## 目录结构

```
web/static/
├── index.html              # 主页面
├── styles.css              # 样式文件
├── README.md               # 项目说明文档
├── STRUCTURE.md            # 项目结构文档（本文件）
└── js/                     # JavaScript模块目录
    ├── core/               # 核心模块
    │   └── client.js       # 核心客户端类
    ├── services/           # 服务层
    │   └── api.js          # API服务
    ├── modules/            # 功能模块
    │   ├── charts.js       # 图表渲染
    │   ├── stockSearch.js  # 股票搜索
    │   ├── config.js       # 配置管理
    │   ├── display.js      # 数据展示
    │   └── events.js       # 事件处理
    ├── utils/              # 工具函数
    │   └── helpers.js      # 通用辅助函数
    └── main.js             # 主入口文件
```

## 静态文件服务

Web客户端现在已集成到Go服务器中，通过以下方式提供服务：

- **访问方式**: 直接访问 `http://localhost:8081/`
- **静态资源**: 所有CSS、JS文件通过服务器提供
- **无需单独Web服务器**: 启动Go服务器即可访问完整Web界面

## 文件说明

### 核心文件

- **`index.html`**: 主页面，包含所有HTML结构和模块引用
- **`styles.css`**: 完整的样式文件，包含所有CSS样式和动画

### JavaScript模块

#### 核心模块 (core/)
- **`client.js`**: 核心客户端类，负责：
  - 客户端初始化
  - 服务器URL检测和配置
  - 健康检查
  - API请求封装
  - 基础工具方法

#### 服务层 (services/)
- **`api.js`**: API服务类，负责：
  - 股票基本信息获取
  - 日线数据获取
  - 技术指标获取
  - 买卖预测获取
  - 股票搜索

#### 功能模块 (modules/)
- **`charts.js`**: 图表渲染模块，负责：
  - K线图创建和配置
  - 移动平均线计算
  - 成交量图表
  - 图表响应式调整

- **`stockSearch.js`**: 股票搜索模块，负责：
  - 实时搜索建议
  - 键盘导航支持
  - 搜索结果显示
  - 股票信息缓存

- **`config.js`**: 配置管理模块，负责：
  - 服务器配置界面
  - 连接测试
  - 配置保存和加载
  - 端口快捷选择

- **`display.js`**: 数据展示模块，负责：
  - 日线数据展示
  - 技术指标展示
  - 预测结果展示
  - 数据格式化

- **`events.js`**: 事件处理模块，负责：
  - 查询按钮事件
  - 键盘事件处理
  - 数据查询逻辑
  - 错误处理

#### 工具函数 (utils/)
- **`helpers.js`**: 通用辅助函数，包含：
  - 防抖和节流函数
  - 数字和货币格式化
  - DOM操作辅助
  - 设备检测
  - 异步工具函数

#### 主入口 (main.js)
- **`main.js`**: 应用主入口，负责：
  - 模块初始化和协调
  - 依赖注入
  - 应用生命周期管理
  - 定期健康检查

## 模块依赖关系

```
main.js
├── client.js (核心依赖)
├── api.js (依赖 client.js)
├── charts.js (依赖 client.js)
├── stockSearch.js (依赖 client.js, api.js)
├── config.js (依赖 client.js)
├── display.js (依赖 client.js, charts.js)
├── events.js (依赖 client.js, api.js, display.js)
└── helpers.js (独立工具函数)
```

## 重构优势

1. **模块化**: 代码按功能分离，每个模块职责单一
2. **可维护性**: 修改某个功能时只需要关注对应模块
3. **可扩展性**: 新增功能时可以轻松添加新模块
4. **可测试性**: 模块化结构便于单元测试
5. **代码复用**: 通用功能可以在不同模块间共享
6. **团队协作**: 不同开发者可以并行开发不同模块

## 加载顺序

JavaScript文件的加载顺序很重要，必须按照以下顺序：

1. 核心模块 (core/)
2. 服务层 (services/)
3. 功能模块 (modules/)
4. 工具函数 (utils/)
5. 主入口文件 (main.js)

这个顺序确保了依赖关系的正确性，避免出现"类未定义"的错误。

## 注意事项

1. 所有模块都通过 `window` 对象导出，确保全局可访问
2. 模块间通过依赖注入的方式协作，降低耦合度
3. 保持了原有功能的完整性，重构不影响用户体验
4. 错误处理机制完整，确保应用的稳定性
