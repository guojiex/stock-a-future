# 策略管理页面 - Web React版本

## 📋 概述

本次更新参考网页版 `web/static/js/modules/strategies.js` 的完整功能，为Web React版本添加了真正的策略管理页面，而不是之前的股票详情页内的策略信息展示。

## 🎯 功能对比

### 原有问题
- React版本的 `StrategyView` 组件只是在股票详情页显示收藏信息
- 缺少独立的策略管理页面
- 无法管理交易策略的CRUD操作
- 无法查看策略性能和运行回测

### 网页版功能(参考)
- ✅ 策略列表卡片式展示
- ✅ 策略创建/编辑/删除
- ✅ 策略状态管理(启用/禁用)
- ✅ 策略详情查看
- ✅ 策略性能指标展示
- ✅ 运行回测功能
- ✅ 策略克隆功能
- ✅ 不同策略类型的参数表单(MACD、双均线、RSI、布林带等)
- ✅ 参数验证逻辑

### 本次实现的功能
- ✅ 独立的策略管理页面 `/strategies`
- ✅ 响应式卡片式策略列表展示
- ✅ 策略编辑对话框
- ✅ 策略删除确认对话框
- ✅ 策略详情查看对话框
- ✅ 策略状态切换(启用/暂停)
- ✅ 运行回测按钮(待集成)
- ✅ 完整的RTK Query API集成
- ✅ Material-UI现代化UI设计

## 📁 文件结构

```
web-react/src/
├── pages/
│   └── StrategiesPage.tsx        # 新增: 策略管理主页面
├── components/
│   └── common/
│       └── Layout.tsx             # 更新: 添加策略导航项
├── services/
│   └── api.ts                    # 更新: 添加策略API端点
└── App.tsx                       # 更新: 添加策略路由
```

## 🔧 技术实现

### 1. 策略管理页面 (`StrategiesPage.tsx`)

**核心功能:**
- 使用 RTK Query 自动管理数据获取和缓存
- Material-UI 组件构建现代化界面
- 响应式网格布局,支持多种屏幕尺寸
- 对话框管理编辑、删除和详情查看

**主要组件:**
```tsx
- 策略卡片: 显示策略名称、类型、状态、参数等
- 编辑对话框: 修改策略配置
- 详情对话框: 查看完整策略信息
- 删除确认对话框: 安全删除策略
```

### 2. API集成 (`api.ts`)

**新增端点:**
```typescript
// 策略列表
getStrategies: () => GET /strategies

// 单个策略详情
getStrategy: (id) => GET /strategies/{id}

// 创建策略
createStrategy: (data) => POST /strategies

// 更新策略
updateStrategy: ({ id, ...data }) => PUT /strategies/{id}

// 删除策略
deleteStrategy: (id) => DELETE /strategies/{id}

// 切换策略状态
toggleStrategy: (id) => POST /strategies/{id}/toggle

// 获取策略性能
getStrategyPerformance: (id) => GET /strategies/{id}/performance
```

### 3. 路由配置

```tsx
<Route path="/strategies" element={<StrategiesPage />} />
```

### 4. 导航菜单

添加策略管理导航项:
- 图标: `AccountTree` (策略树图标)
- 标签: "策略"
- 路径: `/strategies`

## 🎨 UI设计特点

### 1. 响应式布局
- 桌面: 3列卡片网格
- 平板: 2列卡片网格
- 手机: 单列卡片布局

### 2. 策略卡片设计
```
┌─────────────────────────────┐
│ 策略名称            [状态]  │
│ [类型标签]                  │
│ 策略描述文本...             │
│                             │
│ 参数配置:                   │
│ [参数1] [参数2] [+更多]     │
│                             │
│ 创建于: 2024/01/01          │
│ ─────────────────────────   │
│ 👁️ ✏️ ⏸️ 🗑️    [运行回测] │
└─────────────────────────────┘
```

### 3. 状态指示
- 活跃: 绿色徽章
- 非活跃: 灰色徽章
- 测试中: 黄色徽章

### 4. 操作按钮
- 查看详情: 眼睛图标
- 编辑: 铅笔图标
- 启用/暂停: 播放/暂停图标
- 删除: 垃圾桶图标(红色)
- 运行回测: 蓝色按钮

## 🔄 数据流

```
用户操作
    ↓
React组件 (StrategiesPage)
    ↓
RTK Query Hook (useGetStrategiesQuery等)
    ↓
API服务 (stockApi)
    ↓
Go后端API (GET /api/v1/strategies)
    ↓
数据库 (SQLite)
```

## 🚀 使用方法

### 1. 访问策略管理页面

在浏览器中导航到:
```
http://localhost:3000/strategies
```

或点击顶部导航栏的"策略"标签

### 2. 查看策略列表

页面自动加载所有策略,显示为卡片网格

### 3. 编辑策略

1. 点击策略卡片上的 ✏️ 图标
2. 在对话框中修改策略信息和参数
3. 点击"保存"按钮

### 4. 删除策略

1. 点击策略卡片上的 🗑️ 图标
2. 在确认对话框中点击"删除"
3. 策略将被永久删除

### 5. 切换策略状态

点击 ⏸️ (暂停) 或 ▶️ (播放) 图标,立即切换策略的启用/禁用状态

### 6. 运行回测

点击"运行回测"按钮,将跳转到回测页面并预选该策略

## 📊 与网页版的对比

| 功能 | 网页版 | React版(本次实现) | 状态 |
|------|--------|------------------|------|
| 策略列表展示 | ✅ | ✅ | 完成 |
| 策略创建 | ✅ | 🚧 | 待实现 |
| 策略编辑 | ✅ | ✅ | 完成 |
| 策略删除 | ✅ | ✅ | 完成 |
| 策略状态切换 | ✅ | ✅ | 完成 |
| 策略详情查看 | ✅ | ✅ | 完成 |
| 策略性能展示 | ✅ | 🚧 | 待集成 |
| 运行回测 | ✅ | 🚧 | 待集成 |
| 策略克隆 | ✅ | ❌ | 待实现 |
| 参数验证 | ✅ | 🚧 | 部分实现 |

## 🔮 后续改进计划

### 短期 (P0)
1. **创建策略对话框**: 实现完整的策略创建流程
2. **策略性能指标**: 集成性能数据展示
3. **回测页面集成**: 完善从策略页面跳转到回测的流程

### 中期 (P1)
4. **策略克隆功能**: 复制已有策略并修改参数
5. **参数动态表单**: 根据策略类型生成不同的参数表单
6. **参数验证增强**: 实时验证参数的有效性
7. **策略对比功能**: 对比多个策略的性能

### 长期 (P2)
8. **策略模板库**: 提供预设的策略模板
9. **策略导入/导出**: 支持策略配置的导入导出
10. **策略回测历史**: 查看策略的历史回测记录
11. **策略优化建议**: 基于历史表现提供参数优化建议

## 🐛 已知问题

1. **创建策略功能**: 按钮存在但功能未实现,点击后只会输出日志
2. **策略性能数据**: API已准备但UI未完全集成
3. **回测跳转**: 跳转逻辑已实现但需要回测页面配合
4. **参数表单**: 目前是通用表单,未根据策略类型优化

## 📚 参考资料

- 网页版策略模块: `web/static/js/modules/strategies.js`
- 网页版回测模块: `web/static/js/modules/backtest.js`
- Material-UI文档: https://mui.com/
- RTK Query文档: https://redux-toolkit.js.org/rtk-query/overview

## 🙏 致谢

本次实现完全参考网页版的优秀设计,将其现代化并适配React技术栈。

---

**更新日期**: 2025-10-14
**版本**: v1.0.0
**作者**: AI编程助手

