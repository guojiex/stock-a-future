# 策略编辑功能说明

## 功能概述

策略编辑功能允许用户对现有的交易策略进行修改，包括策略名称、描述、状态和参数配置。该功能提供了直观的图形界面和完善的数据验证机制。

## 主要特性

### 1. 策略信息编辑
- **策略名称**: 支持修改策略名称，最多100个字符
- **策略描述**: 支持修改策略描述，最多1000个字符  
- **策略状态**: 可切换策略状态（活跃/非活跃/测试中）
- **策略代码**: 支持编辑自定义策略代码（可选）

### 2. 参数配置编辑
系统为不同类型的策略提供专门的参数编辑界面：

#### MACD策略参数
- **快线周期** (1-50): 计算快速EMA的周期，默认12
- **慢线周期** (1-100): 计算慢速EMA的周期，默认26
- **信号线周期** (1-50): MACD信号线的EMA周期，默认9
- **买入阈值** (-1 to 1): MACD线上穿信号线的阈值
- **卖出阈值** (-1 to 1): MACD线下穿信号线的阈值

#### 双均线策略参数
- **短期均线周期** (1-50): 短期移动平均线的周期，默认5
- **长期均线周期** (1-200): 长期移动平均线的周期，默认20
- **均线类型**: 选择计算方法（SMA/EMA/WMA）
- **突破阈值** (0-0.1): 均线突破的确认阈值

#### RSI策略参数
- **RSI周期** (1-50): 计算RSI的周期，默认14
- **超买阈值** (50-100): RSI超买阈值，默认70
- **超卖阈值** (0-50): RSI超卖阈值，默认30

#### 布林带策略参数
- **布林带周期** (1-50): 计算布林带的周期，默认20
- **标准差倍数** (0.5-5): 布林带宽度的标准差倍数，默认2

### 3. 数据验证
- **前端验证**: 实时验证用户输入，提供即时反馈
- **后端验证**: 服务器端验证确保数据完整性和安全性
- **参数约束**: 根据策略类型执行特定的参数约束检查

## 使用方法

### 1. 打开编辑界面
1. 在策略管理页面，找到要编辑的策略
2. 点击策略卡片上的"编辑"按钮（✏️图标）
3. 或在策略详情页面点击"编辑策略"按钮

### 2. 编辑策略信息
1. 在弹出的编辑模态框中修改策略信息
2. 系统会根据策略类型自动生成相应的参数配置表单
3. 修改所需的参数值，系统会实时验证输入

### 3. 保存修改
1. 点击"保存修改"按钮提交更改
2. 系统会验证所有输入并保存到后端
3. 成功保存后会自动刷新策略列表和详情显示

### 4. 取消编辑
- 点击"取消"按钮或模态框外部区域关闭编辑界面
- 点击"重置"按钮恢复到原始值

## API接口

### 更新策略
```http
PUT /api/v1/strategies/{id}
Content-Type: application/json

{
  "name": "策略名称",
  "description": "策略描述", 
  "status": "active|inactive|testing",
  "parameters": {
    // 策略特定参数
  },
  "code": "策略代码（可选）"
}
```

### 响应格式
```json
{
  "success": true,
  "message": "策略更新成功"
}
```

## 技术实现

### 前端架构
- **模态框组件**: 使用原生JavaScript实现的响应式编辑界面
- **动态表单**: 根据策略类型动态生成参数配置表单
- **实时验证**: 前端JavaScript实现的输入验证和错误提示
- **状态管理**: 本地策略数据的同步更新

### 后端架构
- **RESTful API**: 标准的HTTP PUT接口处理更新请求
- **数据验证**: Go语言实现的多层验证机制
- **错误处理**: 完善的错误处理和用户友好的错误信息

### 样式设计
- **响应式布局**: 支持桌面和移动设备
- **现代化UI**: 使用CSS Grid和Flexbox布局
- **用户体验**: 平滑的动画效果和直观的交互反馈

## 注意事项

1. **策略类型不可修改**: 策略创建后其类型（technical/fundamental/ml/composite）不能更改
2. **参数约束**: 不同策略类型有特定的参数约束，系统会自动验证
3. **名称唯一性**: 策略名称在系统中必须唯一
4. **实时生效**: 策略参数修改后会立即影响后续的信号生成
5. **版本控制**: 系统会记录策略的更新时间，但不保留历史版本

## 错误处理

常见错误及解决方法：

- **"策略名称已存在"**: 使用其他未被使用的策略名称
- **"参数超出范围"**: 检查参数值是否在允许的范围内
- **"网络连接失败"**: 检查服务器连接状态
- **"权限不足"**: 确认用户有编辑策略的权限

## 扩展性

该功能设计具有良好的扩展性：

1. **新策略类型**: 可轻松添加新的策略类型和对应的参数表单
2. **参数类型**: 支持添加新的参数类型和验证规则
3. **UI组件**: 模块化的组件设计便于功能扩展
4. **API接口**: 标准的RESTful设计便于集成和扩展

## 测试验证

系统包含完整的测试验证：

1. **单元测试**: 后端服务层和处理器层的单元测试
2. **集成测试**: API接口的集成测试
3. **前端测试**: JavaScript功能的测试验证
4. **用户测试**: 完整的用户操作流程测试

策略编辑功能已通过全面测试，确保在各种场景下的稳定性和可靠性。
